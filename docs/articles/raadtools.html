<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the raadtools package • raadtools</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">raadtools</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AustralianAntarcticDivision/raadtools">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Using the raadtools package</h1>
                        <h4 class="author">Michael D. Sumner</h4>
            
            <h4 class="date">2017-06-17</h4>
          </div>

    
    
<div class="contents">
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>The <code>raadtools</code> package provides a set of helper functions based on functionality in the <code>raster</code> package, to simplify fast and efficient use of time series environmental data including</p>
<ul>
<li>chlorophyll-a concentation</li>
<li>colour images</li>
<li>sea ice concentration</li>
<li>sea surface current vectors</li>
<li>sea surface height and height anomaly</li>
<li>sea surface temperature</li>
<li>sea surface wind vectors.</li>
</ul>
<p>There is ongoing work to simplify extension of these tools to a wider range of data, but here we focus on the existing examples just to highlight the preferred ways of working with these data in <code>R</code>.</p>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This document introduces the <code>raadtools</code> package. Some familiarity with <code>R</code> and the <code>raster</code> package is assumed.</p>
<p>This package relies on the availability of a local file repository which must be present, see the componente packages <a href="raadsync">https://github.com/AustralianAntarcticDataCentre/raadsync</a> and <a href="raadtools">https://github.com/AustralianAntarcticDivision/raadtools</a>.</p>
<p>The very first step is to load the package, which also triggers an attempt to connect to the file repository.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raadtools)
<span class="kw">library</span>(raster)</code></pre></div>
<p>(TO FIX: In subsequent code sections I’m also attaching raadfiles explicitly to make this document work, but it’s not necessary generally. )</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raadfiles)
<span class="kw">library</span>(raadtools)

ice &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readice.html">readice</a></span>()
<span class="kw">plot</span>(ice)</code></pre></div>
<p><img src="figure/minimal-unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="simple-data-read" class="section level1">
<h1 class="hasAnchor">
<a href="#simple-data-read" class="anchor"></a>Simple data read</h1>
<p>There are functions to read data based on a sequence of date-time values.</p>
<p>At the simplest level, these functions may be run without setting any arguments and will return the first available time step for the default data source. This is handy for becoming familiar with the kinds of data before getting really specific. Plotting the resulting <code>ice} object provides a familiar polar view. These data are a single time slice from the daily passive microwave sea ice concentration, here the very first one that is available (from</code>raster::getZ(ice)`).</p>
<p>Other read functions include <code>reachla</code>, <code>readcurr</code>, <code>readsst</code>, <code>readwind</code> and <code>readtopo</code>. Each of these will read a default data set in a similar way to the ice example, see their respective help pages and explore the index page of <code>raadtools</code> to see an overview of functionality.</p>
<p>Load up the package help index for an overview of all the help topics and functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="dt">help =</span> raadtools)</code></pre></div>
<p>Read a simple example from each of the data types mentioned above and plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raadtools)
<span class="kw">library</span>(raadfiles)
## chlorophyll-a is currently only patchily supported
##chla &lt;- readchla("2009-10-01")
curr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readcurr.html">readcurr</a></span>(<span class="st">"2012-01-09"</span>, <span class="dt">magonly =</span> <span class="ot">TRUE</span>, <span class="dt">lon180 =</span> <span class="ot">FALSE</span>)
sst &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readsst.html">readsst</a></span>(<span class="kw">c</span>(<span class="st">"2000-01-01"</span>, <span class="st">"2009-06-08"</span>))
wind &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readwind.html">readwind</a></span>()
##topo &lt;- readtopo("george_v_terre_adelie", xylim = extent(140, 141.5, -65, -64))

apal &lt;-<span class="st"> </span><span class="kw"><a href="../reference/chl.pal.html">chl.pal</a></span>(<span class="dt">palette =</span> <span class="ot">TRUE</span>)
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfcol =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="co">#plot(chla, col = chl.pal(apal$breaks), breaks = apal$breaks,</span>
<span class="co">#     main = "Johnson chl-a", legend = FALSE)</span>
<span class="kw">plot</span>(curr, <span class="dt">main =</span> <span class="st">"ocean surface current magnitude"</span>)
<span class="kw">plot</span>(sst[[<span class="dv">2</span>]], <span class="dt">main =</span> <span class="st">"SST"</span>)
<span class="co">#plot(topo, main = "George V Terre Adelie bathymetry",</span>
<span class="co">#     col = topo.colors(68)[-c(40:68)])</span>
<span class="kw">par</span>(op)

<span class="kw">plot</span>(wind, <span class="dt">nr =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="figure/minimal-unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"><img src="figure/minimal-unnamed-chunk-4-2.png" width="672" style="display: block; margin: auto;"></p>
<p>The read calls above apply slightly different options in each case, with no arguments at all, with a vector of date-times, <code>xylim</code> to restrict the spatial extent an <code>lon180</code> to control the Atlantic vs. Pacific view for global data extending across the dateline.</p>
<p>The <code>ice</code> object is a <code>class(ice)</code> from the <code>raster</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ice</code></pre></div>
<pre><code>## class       : RasterStack 
## dimensions  : 332, 316, 104912, 1  (nrow, ncol, ncell, nlayers)
## resolution  : 25000, 25000  (x, y)
## extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs 
## names       : nt_19781026_n07_v01_s.bin 
## min values  :                         0 
## max values  :                       100 
## time        : 1978-10-26</code></pre>
<p>This object is a <code>RasterLayer</code> which consists of just a single grid layer for the day listed at the beginning of the NSIDC data set. The dimensions of the grid are listed, (in the order Y then X) <code>dim(ice)[1:2]</code> and these refer to the number of cells seen vertically on the page (<code>nrow(ice)</code>) and those seen horizontally (<code>ncol(ice)</code>), and then the total number of cells (X * Y).</p>
<div id="leveraging-raster-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#leveraging-raster-in-r" class="anchor"></a>Leveraging raster in R</h2>
<p>The <code>raster</code> package provides excellent facilities for working with raster data, including images, surfaces, DEMs and time series satellite data. From the <code>raster</code> package DESCRIPTION:</p>
<pre><code>Reading, writing, manipulating, analyzing and modeling of
gridded spatial data. The package implements basic and high-level
functions and processing of very large files is supported.</code></pre>
<p>This package should be consulted for documentation on the use of Raster objects, and in particular the vignette <code>Raster</code> is a good place to start. Use the <code>library</code> function’s <code>help</code> argument to get an overview of the available functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster)

## opens an index page to all of the package's functions
<span class="kw">library</span>(<span class="dt">help =</span> raster)
## opens a PDF document with extended help and examples
<span class="kw">vignette</span>(<span class="st">"Raster"</span>)</code></pre></div>
<p>See the Section sec:assumedsupport for more detail on the design choices made with <code>raster</code> and the other package dependencies used by <code>raadtools</code>.</p>
</div>
</div>
<div id="read-functions-in-raadtools" class="section level1">
<h1 class="hasAnchor">
<a href="#read-functions-in-raadtools" class="anchor"></a>Read functions in raadtools</h1>
<p>This section discusses the details of individual read functions and some of the rationale behind each one. Different data sets are stored with different native coordinate systems, different pixel and temporal resolutions, different data units, and cover different spatial and temporal ranges. As well as all these options, the way data are stored varies tremendously depending on the provider and the data type. These read functions all return either a <code>Raster} object as defined by the</code>raster` package with as complete and standard metadata as possible.</p>
<p>Some data sets are inherently multi-layered for a single time step, such as wind and current vectors and so these both have optional arguments <code>dironly</code> and <code>magonly</code> to convert the internal <code>U</code> and <code>V</code> vector components to directions or magnitudes only. The read operation may be combined with a spatial crop by using the argument <code>xylim</code> and there are other options specific for some data sets such as <code>lon180</code> to control the default orientation (these topics will be discussed in more detail in later sections, otherwise see the documentation for each function argument).</p>
<div id="read-topographic-or-bathymetric-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-topographic-or-bathymetric-data" class="anchor"></a>Read topographic or bathymetric data</h2>
<p>The <code>readtopo</code> (<code>readbathy</code> is a synonym) will return one of several available data sets. See the help page for the details and source of each one. As these data are not dynamic on short time scales they do not provide a <code>date</code> argument. The <code>ibcso</code> data set is optionally available on a polar or longitude/latitude grid, controlled by the <code>polar</code> argument. The Smith and Sandwell data set is returned in Pacific view on the Mercator projection by default. Use <code>lon180 = FALSE</code> to return Atlantic view.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raadtools)
<span class="kw">library</span>(raadfiles)
geb &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readtopo.html">readtopo</a></span>(<span class="st">"gebco_08"</span>, <span class="dt">xylim =</span> <span class="kw">extent</span>(<span class="dv">150</span>, <span class="dv">220</span>, -<span class="dv">75</span>, -<span class="dv">60</span>))
<span class="kw">plot</span>(geb, <span class="dt">col =</span> viridis::<span class="kw">inferno</span>(<span class="dv">100</span>))</code></pre></div>
<p><img src="figure/minimal-unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="plot-vector-data" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-vector-data" class="anchor"></a>Plot vector data</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raadtools)
<span class="kw">library</span>(raadfiles)
## set up data in advance, to feed the plotting function
tst &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readcurr.html">readcurr</a></span>()
xylim &lt;-<span class="st"> </span><span class="kw">extent</span>(<span class="kw">projectExtent</span>(<span class="kw">raster</span>(<span class="kw">extent</span>(<span class="dv">130</span>, <span class="dv">150</span>, -<span class="dv">50</span>, -<span class="dv">30</span>), <span class="dt">crs =</span> <span class="st">"+proj=longlat"</span>), <span class="kw">projection</span>(tst)))

plotcurrents &lt;-<span class="st"> </span>function(<span class="dt">date =</span> <span class="kw">as.Date</span>(<span class="st">"1999-11-24"</span>), <span class="dt">ext =</span> <span class="ot">NULL</span>, <span class="dt">scale =</span> <span class="dv">2</span>, ...) {
  x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readcurr.html">readcurr</a></span>(date)
  if (!<span class="kw">is.null</span>(ext)) x &lt;-<span class="st"> </span><span class="kw">crop</span>(x, ext)
  crds &lt;-<span class="st"> </span><span class="kw">coordinates</span>(x)
  <span class="kw">plot</span>(<span class="kw">sqrt</span>(x[[1L]]^<span class="dv">2</span> +<span class="st"> </span>x[[2L]]^<span class="dv">2</span>), ...)
  x1 &lt;-<span class="st"> </span>crds[,<span class="dv">1</span>]
  y1 &lt;-<span class="st"> </span>crds[,<span class="dv">2</span>]
  x2 &lt;-<span class="st"> </span>crds[,<span class="dv">1</span>] +<span class="st"> </span><span class="kw">values</span>(x[[1L]]) *<span class="st"> </span>scale
  y2 &lt;-<span class="st"> </span>crds[,<span class="dv">2</span>] +<span class="st"> </span><span class="kw">values</span>(x[[2L]]) *<span class="st"> </span>scale
  op &lt;-<span class="st"> </span><span class="kw">options</span>(<span class="dt">warn =</span> -<span class="dv">1</span>)
  <span class="kw">sink</span>(<span class="st">"/dev/null"</span>)
  <span class="kw">arrows</span>(x1, y1, x2, y2, <span class="dt">length =</span> <span class="fl">0.03</span>, <span class="dt">col =</span> <span class="st">"#00000080"</span>)
  <span class="kw">sink</span>(<span class="ot">NULL</span>)
  <span class="kw">options</span>(op)
  <span class="kw">invisible</span>(<span class="ot">NULL</span>)
}

<span class="kw">plotcurrents</span>(<span class="dt">date =</span> <span class="kw">as.Date</span>(<span class="st">"2000-01-05"</span>), <span class="dt">ext =</span> xylim, <span class="dt">scale =</span> .<span class="dv">1</span>, <span class="dt">asp =</span> <span class="ot">NA</span>)</code></pre></div>
<p><img src="figure/minimal-unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Animate a series of current plots as above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raadtools)
<span class="kw">library</span>(raadfiles)
dts &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">as.Date</span>(<span class="st">"2005-10-01"</span>), <span class="dt">length =</span> <span class="dv">104</span>, <span class="dt">by =</span> <span class="st">"1 week"</span>)
pal &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sst.pal.html">sst.pal</a></span>(<span class="dt">palette =</span> <span class="ot">TRUE</span>)
cols &lt;-<span class="st"> </span>pal$cols[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(pal$cols), <span class="dt">length =</span> <span class="dv">16</span>)]
cols &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"ff$"</span>, <span class="st">"99"</span>, cols)
brks &lt;-<span class="st"> </span>pal$breaks[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(pal$breaks), <span class="dt">length =</span> <span class="dv">16</span>)]

<span class="co">#library(animation)</span>
<span class="co">#ani.start()</span>
<span class="co">#for (i in seq_along(dts)) plotcurrents(dts[i], ext = xylim, scale = 2500, col = cols, breaks = brks)</span>
<span class="co">#ani.stop()</span></code></pre></div>
</div>
<div id="extract-spatio-temporal-data-from-read-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#extract-spatio-temporal-data-from-read-functions" class="anchor"></a>Extract spatio-temporal data from read functions</h1>
<p>These have all be tested at some point, though maybe not in the current version of this document.</p>
<p>More needs to be said here, and pictures . . .</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raadtools)


a &lt;-<span class="st"> </span><span class="kw">structure</span>(<span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">174</span>, <span class="dv">168</span>, <span class="dv">156</span>, <span class="dv">111</span>, <span class="dv">99</span>, <span class="dv">64</span>, <span class="dv">52</span>, <span class="dv">46</span>, -<span class="dv">4</span>,
                          -<span class="dv">15</span>, -<span class="dv">30</span>, -<span class="dv">38</span>, -<span class="dv">47</span>, -<span class="dv">62</span>, -<span class="dv">87</span>, -<span class="dv">127</span>, -<span class="dv">145</span>, -<span class="dv">160</span>, -<span class="dv">161</span>), <span class="dt">y =</span> <span class="kw">c</span>(-<span class="dv">72</span>,
                                                                                       -<span class="dv">39</span>, -<span class="dv">50</span>, -<span class="dv">58</span>, -<span class="dv">35</span>, -<span class="dv">38</span>, -<span class="dv">48</span>, -<span class="dv">60</span>, -<span class="dv">48</span>, -<span class="dv">35</span>, -<span class="dv">37</span>, -<span class="dv">51</span>, -<span class="dv">68</span>, -<span class="dv">72</span>,
                                                                                       -<span class="dv">69</span>, -<span class="dv">54</span>, -<span class="dv">40</span>, -<span class="dv">49</span>, -<span class="dv">54</span>)), <span class="dt">.Names =</span> <span class="kw">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="dt">row.names =</span> <span class="kw">c</span>(<span class="ot">NA</span>,
                                                                                                                                                      -19L), <span class="dt">class =</span> <span class="st">"data.frame"</span>)

a$time &lt;-<span class="st">  </span><span class="kw">sort</span>(<span class="kw">as.Date</span>(<span class="st">"2005-01-01"</span>) +<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">20</span>, <span class="dv">50</span>), <span class="kw">nrow</span>(a), <span class="dt">replace =</span> <span class="ot">TRUE</span>))

<span class="kw"><a href="../reference/extract.html">extract</a></span>(readssh, a)
<span class="kw"><a href="../reference/extract.html">extract</a></span>(readssh, a, <span class="dt">ssha =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="../reference/extract.html">extract</a></span>(readcurr, a, <span class="dt">magonly =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="../reference/extract.html">extract</a></span>(readice, a)

<span class="co">#extract(readchla, time.resolution = "weekly")</span>
<span class="co">#extract(readchla, a, time.resolution = "weekly")</span>



##extract(readwind, a)
<span class="kw"><a href="../reference/extract.html">extract</a></span>(readwind)
<span class="kw"><a href="../reference/readwind.html">readwind</a></span>(<span class="dt">dironly =</span> <span class="ot">TRUE</span>)



a$time &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.Date</span>(<span class="st">"1985-01-01"</span>) +<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">50</span>), <span class="kw">nrow</span>(a), <span class="dt">replace =</span> <span class="ot">TRUE</span>))


##x &lt;- extract(readsst)
##extract(readsst, a)


##extract(readsst)
##extract(readsst, time.resolution = "daily")


##extract(readsst, a)</code></pre></div>
<div id="extract-spatio-temporal-data-with-spatial-temporal-interpolation-and-spatial-aggregation" class="section level2">
<h2 class="hasAnchor">
<a href="#extract-spatio-temporal-data-with-spatial-temporal-interpolation-and-spatial-aggregation" class="anchor"></a>Extract spatio-temporal data with spatial, temporal interpolation, and spatial aggregation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lon =</span> <span class="kw">c</span>(<span class="dv">130</span>, <span class="dv">125</span>, <span class="dv">120</span>, -<span class="fl">52.27</span>, <span class="fl">123.21</span>, -<span class="fl">25.42</span>, <span class="fl">36.96</span>, -<span class="fl">36.28</span>),
                 <span class="dt">lat =</span> <span class="kw">c</span>(-<span class="dv">50</span>, -<span class="dv">52</span>, -<span class="dv">55</span>,-<span class="fl">66.31</span>, -<span class="fl">74.55</span>, -<span class="fl">69.66</span>, -<span class="fl">71.85</span>, -<span class="fl">68.56</span>),
                 <span class="dt">gmt =</span> <span class="kw">as.POSIXct</span>(<span class="st">"2006-02-08 00:00:00"</span>) +<span class="st"> </span><span class="dv">24</span> *<span class="dv">3600</span> *<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">106</span>, <span class="dv">118</span>, <span class="dv">118</span>, <span class="dv">190</span>))

llproj &lt;-<span class="st"> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0"</span>

<span class="kw">library</span>(raadtools)
<span class="kw">library</span>(rgdal)

## test extract vs extractxyt
sst1 &lt;-<span class="st"> </span><span class="kw">extractxyt</span>(<span class="st">"oisst"</span>, d1)
sst2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract.html">extract</a></span>(readsst, d1)

mag1 &lt;-<span class="st"> </span><span class="kw">extractxyt</span>(<span class="st">"aviso"</span>, d1, <span class="dt">magonly =</span> <span class="ot">TRUE</span>)
mag2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract.html">extract</a></span>(readcurr, d1, <span class="dt">magonly =</span> <span class="ot">TRUE</span>)

ice1 &lt;-<span class="st"> </span><span class="kw">extractxyt</span>(<span class="st">"nsidc"</span>, d1)
ice2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract.html">extract</a></span>(readice, d1)

## these diffs should be  zorro
<span class="kw">max</span>(<span class="kw">abs</span>(sst1 -<span class="st"> </span>sst2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
<span class="kw">max</span>(<span class="kw">abs</span>(mag1 -<span class="st"> </span>mag2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
<span class="kw">max</span>(<span class="kw">abs</span>(ice1 -<span class="st"> </span>ice2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)


## now the goodstuff
sst3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract.html">extract</a></span>(readsst, d1, <span class="dt">method =</span> <span class="st">"bilinear"</span>)
sst4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract.html">extract</a></span>(readsst, d1, <span class="dt">ctstime =</span> <span class="ot">TRUE</span>)
sst5 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract.html">extract</a></span>(readsst, d1, <span class="dt">ctstime =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">"bilinear"</span>)

<span class="kw">data.frame</span>(<span class="dt">sst =</span> sst2, <span class="dt">sst_xyinterp =</span> sst3, <span class="dt">sst_timeinterp =</span> sst4, <span class="dt">sst_spacetimeinterp =</span> sst5)

## some time when we get chl-a
d2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(-<span class="dv">40</span>, -<span class="dv">25</span>, -<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">33</span>, <span class="dv">60</span>, <span class="dv">89</span>, <span class="dv">107</span>),
                 <span class="dt">y =</span> <span class="kw">c</span>(-<span class="dv">56</span>, -<span class="dv">55</span>, -<span class="dv">59</span>, -<span class="dv">62</span>, -<span class="dv">64</span>, -<span class="dv">62</span>, -<span class="dv">60</span>, -<span class="dv">60</span>),
                 <span class="dt">time =</span> <span class="kw">as.POSIXct</span>(<span class="st">"2006-12-18 00:00:00"</span>) +<span class="st"> </span><span class="dv">24</span> *<span class="dv">3600</span> *<span class="st"> </span><span class="dv">7</span> *<span class="st"> </span><span class="kw">seq_len</span>(<span class="dv">8</span>))

## resize by a factor in space so we get "more coverage"
<span class="co"># chla1 &lt;- extract(readchla, d2)</span>
<span class="co"># chla2 &lt;- extract(readchla, d2, ctstime = TRUE, method = "bilinear")</span>
<span class="co"># chla3 &lt;- extract(readchla, d2, ctstime = TRUE, method = "bilinear", fact = 16)</span>
<span class="co"># data.frame(chla = chla1, chla_spacetimeinterp = chla2, chla_resizespacetimeinterp = chla3)</span>
<span class="co"># </span>
<span class="co"># chl &lt;- readchla(d2$time, xylim = extent(as.matrix(d2[,1:2])))</span>
<span class="co"># chl2 &lt;- aggregate(chl, fact = 16)</span>
<span class="co"># pal &lt;- chl.pal(palette = TRUE)</span>
<span class="co"># </span>
<span class="co"># ## compare the two plots, with and without spatial aggregation for "coverage"</span>
<span class="co"># plot(chl, col = pal$col, breaks = pal$breaks, legend = FALSE, addfun = function() lines(d2[,1:2]))</span>
<span class="co"># </span>
<span class="co"># plot(chl2, col = pal$col, breaks = pal$breaks, legend = FALSE, addfun = function() lines(d2[,1:2]))</span>
<span class="co"># </span></code></pre></div>
</div>
</div>
<div id="data-sets-and-the-native-projection" class="section level1">
<h1 class="hasAnchor">
<a href="#data-sets-and-the-native-projection" class="anchor"></a>Data sets and the native projection</h1>
<p>All data sets availalable in <code>raadtools</code> are provided in their  * This document was built with <code>knitr</code><a href="http://yihui.name/knitr/" class="uri">http://yihui.name/knitr/</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#simple-data-read">Simple data read</a><ul class="nav nav-pills nav-stacked">
<li><a href="#leveraging-raster-in-r">Leveraging raster in R</a></li>
      </ul>
</li>
      <li>
<a href="#read-functions-in-raadtools">Read functions in raadtools</a><ul class="nav nav-pills nav-stacked">
<li><a href="#read-topographic-or-bathymetric-data">Read topographic or bathymetric data</a></li>
      </ul>
</li>
      <li><a href="#plot-vector-data">Plot vector data</a></li>
      <li>
<a href="#extract-spatio-temporal-data-from-read-functions">Extract spatio-temporal data from read functions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#extract-spatio-temporal-data-with-spatial-temporal-interpolation-and-spatial-aggregation">Extract spatio-temporal data with spatial, temporal interpolation, and spatial aggregation</a></li>
      </ul>
</li>
      <li><a href="#data-sets-and-the-native-projection">Data sets and the native projection</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael D. Sumner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
