library(testthat)
library(raadtools)


x <- structure(list(x = c(110.553900621445, 98.2410256421585, 84.618270345927,
61.826352831078, 22.7919193861068, -14.932633741919, -34.8428145594882,
-49.7754501726651, -39.2964076371024, -12.5748491714174, -25.4116762774817,
-115.79341814671, -151.946114894402, -158.495516479128, -151.684138831013,
-142.776952675784, -129.94012556972, 110.553900621445), y = c(-56.8847314360873,
-61.0921037478307, -63.0455266068544, -63.1957899037024, -64.0973696847903,
-64.5481595753342, -72.512114308277, -72.9629041988209, -62.1439468257665,
-55.9831516549995, -46.9673538441208, -59.439207482503, -44.8636676882491,
-64.2476329816382, -67.7036888091417, -69.2063217776215, -62.7450000131585,
-56.8847314360873), time = structure(c(1045785600, 1045872000,
1045958400, 1058659200, 1058745600, 1058832000, 1058918400, 1059004800,
1059091200, 1059177600, 1059264000, 1059523200, 1059782400, 1060041600,
1060128000, 1060214400, 1060300800, 1060387200), class = c("POSIXct",
"POSIXt"))), .Names = c("x", "y", "time"), row.names = c(NA,
-18L), class = "data.frame")


asst <- extractxyt("oisst", x)
aaviso <- extractxyt("aviso", x, magonly = TRUE)
ansidc <- extractxyt("nsidc", x)
## user  system elapsed
##  35.65    4.82   48.81

test_that("a data value is returned for each time", {
    expect_that(length(asst), equals(nrow(x)))
    expect_that(length(aaviso), equals(nrow(x)))
    expect_that(length(ansidc), equals(nrow(x)))

})

testsst <- c(3.66999991796911, 1.55999996513128, 1.05999997630715, -1.62999996356666,
-1.75999996066093, -1.75999996066093, -1.79999995976686, -1.79999995976686,
-1.59999996423721, -0.57999998703599, 5.45999987795949, 3.2699999269098,
9.55999978631735, -1.65999996289611, -1.66999996267259, -1.719999961555,
0.189999995753169, 0.879999980330467)

testaviso <- c(11.4536519975338, 1.13382257511702, 14.9936783463502, 3.37949960373626,
NA, NA, NA, NA, NA, 10.7350154121931, 15.6438742109641, 11.7600223892725,
1.12729609447336, 3.50125189669809, NA, NA, 4.51125580138089,
4.09312315699995)

testnsidc <- c(NA, NA, NA, 74, 92.8, 100, 100, 99.2, 80.4, NA, NA, NA, NA,
84.8, 86, 89.2, NA, NA)

test_that("the right data is returned", {
    expect_that(asst, equals(testsst))
    expect_that(aaviso, equals(testaviso))
    expect_that(ansidc, equals(testnsidc))

})
